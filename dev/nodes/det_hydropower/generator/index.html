<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hydro generator node · EnergyModelsRenewableProducers</title><meta name="title" content="Hydro generator node · EnergyModelsRenewableProducers"/><meta property="og:title" content="Hydro generator node · EnergyModelsRenewableProducers"/><meta property="twitter:title" content="Hydro generator node · EnergyModelsRenewableProducers"/><meta name="description" content="Documentation for EnergyModelsRenewableProducers."/><meta property="og:description" content="Documentation for EnergyModelsRenewableProducers."/><meta property="twitter:description" content="Documentation for EnergyModelsRenewableProducers."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">EnergyModelsRenewableProducers</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../manual/quick-start/">Quick Start</a></li><li><a class="tocitem" href="../../../manual/simple-example/">Examples</a></li><li><a class="tocitem" href="../../../manual/NEWS/">Release notes</a></li></ul></li><li><span class="tocitem">Nodes</span><ul><li><a class="tocitem" href="../../nondisres/">Non-dispatchable RES</a></li><li><a class="tocitem" href="../../hydropower/">Simple Hydropower</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Detailed hydropower</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../description/">Detailed hydropower</a></li><li><a class="tocitem" href="../reservoir/">Hydro reservoir node</a></li><li class="is-active"><a class="tocitem" href>Hydro generator node</a><ul class="internal"><li><a class="tocitem" href="#nodes-det_hydro_power-generator-fields"><span>Introduced type and its field</span></a></li><li><a class="tocitem" href="#nodes-det_hydro_power-generator-math"><span>Mathematical description</span></a></li></ul></li><li><a class="tocitem" href="../pump/">Hydro pump node</a></li><li><a class="tocitem" href="../gate/">Hydro gate node</a></li></ul></li><li><a class="tocitem" href="../../battery/">Battery</a></li></ul></li><li><span class="tocitem">How to</span><ul><li><a class="tocitem" href="../../../how-to/update-models/">Update models</a></li><li><a class="tocitem" href="../../../how-to/contribute/">Contribute to EnergyModelsRenewableProducers</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../../library/public/">Public</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../library/internals/types-EMRP/">Types</a></li><li><a class="tocitem" href="../../../library/internals/methods-fields/">Methods - Accessing fields</a></li><li><a class="tocitem" href="../../../library/internals/methods-EMRP/">Methods - Internal</a></li><li><a class="tocitem" href="../../../library/internals/methods-EMB/">Methods - <code>EnergyModelsBase</code></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Nodes</a></li><li><a class="is-disabled">Detailed hydropower</a></li><li class="is-active"><a href>Hydro generator node</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hydro generator node</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EnergyModelsX/EnergyModelsRenewableProducers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EnergyModelsX/EnergyModelsRenewableProducers.jl/blob/main/docs/src/nodes/det_hydropower/generator.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="nodes-det_hydro_power-generator"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator">Hydro generator node</a><a id="nodes-det_hydro_power-generator-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator" title="Permalink"></a></h1><h2 id="nodes-det_hydro_power-generator-fields"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-fields">Introduced type and its field</a><a id="nodes-det_hydro_power-generator-fields-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-fields" title="Permalink"></a></h2><p>The <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> node represents a hydropower unit used to generate electricity in a hydropower system. In its simplest form, the <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> can convert potential energy stored in the reservoirs to electricity by discharging water between reservoirs at different head levels under the assumption that the reservoirs have constant head level. The conversion to electric energy can be described by an power-discharge relationship referred to as the PQ-curve.</p><h3 id="nodes-det_hydro_power-generator-fields-stand"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-fields-stand">Standard fields</a><a id="nodes-det_hydro_power-generator-fields-stand-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-fields-stand" title="Permalink"></a></h3><p><a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> nodes build on the <a href="../../../library/internals/types-EMRP/#EnergyModelsRenewableProducers.HydroUnit"><code>HydroUnit</code></a> and the  <a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/library/public/nodes/#EnergyModelsBase.RefNetworkNode"><code>RefNetworkNode</code> </a> nodes, but add additional fields. The standard fields are:</p><ul><li><p><strong><code>id</code></strong>:<br/>The field <code>id</code> is only used for providing a name to the node. This is similar to the approach utilized in <code>EnergyModelsBase</code>.</p></li><li><p><strong><code>cap::TimeProfile</code></strong>:<br/>The installed capacity corresponds to the nominal capacity of the node. It can refer to either the installed power or discharge capacity of the hydropower unit.</p></li><li><p><strong><code>opex_var::TimeProfile</code></strong>:<br/>The variable operational expenses are based on the capacity utilization through the variable <a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var-cap"><code>cap_use</code></a>.</p></li><li><p><strong><code>opex_fixed::TimeProfile</code></strong>:<br/>The fixed operating expenses are relative to the installed capacity (through the field <code>cap</code>) and the chosen duration of a strategic period as outlined on <em><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/how-to/utilize-timestruct/#how_to-utilize_TS">Utilize <code>TimeStruct</code></a></em>.<br/>It is important to note that you can only use <code>FixedProfile</code> or <code>StrategicProfile</code> for the fixed OPEX, but not <code>RepresentativeProfile</code> or <code>OperationalProfile</code>. In addition, all values have to be non-negative.</p></li><li><p><strong><code>data::Vector{Data}</code></strong>:<br/>An entry for providing additional data to the model.</p><div class="admonition is-info"><header class="admonition-header">Additional constraints</header><div class="admonition-body"><p>The <code>data</code> field can be used to add minimum, maximum, and schedule constraints on the power generation or water discharge using the general <em><a href="../description/#nodes-det_hydro_power-phil-con">constraints types</a></em>.</p></div></div></li></ul><div class="admonition is-warning"><header class="admonition-header">Input/output fields</header><div class="admonition-body"><p><a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> nodes do not utilize the fields <code>input</code> and <code>output</code>. Instead, the input and output resources are identified from the fields <code>water_resource</code> and <code>electricity_resource</code> described below.</p></div></div><h3 id="nodes-det_hydro_power-generator-fields-add"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-fields-add">Additional fields</a><a id="nodes-det_hydro_power-generator-fields-add-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-fields-add" title="Permalink"></a></h3><p><a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> nodes introduce the following additional fields:</p><ul><li><p><strong><code>pq_curve::AbstractPqCurve</code></strong>:<br/>Describes the <em><a href="../description/#nodes-det_hydro_power-phil-pq">relationship between generated power (electricity) and discharge of water</a></em>. The input can be provided by using the subtype <a href="../../../library/public/#EnergyModelsRenewableProducers.PqPoints"><code>PqPoints</code></a> or as a single energy equivalent.</p><div class="admonition is-warning"><header class="admonition-header">pq_curve</header><div class="admonition-body"><p>The input provided to the <code>pq_curve</code> field has to be relative to the installed capacity, so that either the maximum discharge or the maximum power value given by the <a href="../../../library/public/#EnergyModelsRenewableProducers.PqPoints"><code>PqPoints</code></a> equals 1. If a single energy equivalent is provided, it is required that the field <code>cap</code> must refer to the power capacity of the <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> node.</p></div></div></li><li><p><strong><code>water_resource::Resource</code></strong>:<br/>The water resource that the node discharges to generate electricity.</p></li><li><p><strong><code>electricity_resource::Resource</code></strong>:<br/>The electricity resource generated from the node.</p></li></ul><div class="admonition is-info"><header class="admonition-header">Input/output fields</header><div class="admonition-body"><p><a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> nodes include the fields <code>water_resource</code> and <code>electricity_resource</code> field instead of the <code>input</code> and <code>output</code> fields of <a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/library/public/nodes/#EnergyModelsBase.RefNetworkNode"><code>RefNetworkNode</code></a>. The conversion of the water resource is set to 1 since the amount of water in the system is constant. The conversion to electricity is described by the input provided in the <code>pq_curve::AbstractPqCurve</code> field.</p></div></div><h2 id="nodes-det_hydro_power-generator-math"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-math">Mathematical description</a><a id="nodes-det_hydro_power-generator-math-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-math" title="Permalink"></a></h2><p>The <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> inherits its mathematical description from the <a href="../../../library/internals/types-EMRP/#EnergyModelsRenewableProducers.HydroUnit"><code>HydroUnit</code></a> which is an abstract subtype of <a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/library/public/nodes/#EnergyModelsBase.NetworkNode">NetworkNode</a>.</p><h3 id="nodes-det_hydro_power-generator-math-var"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-math-var">Variables</a><a id="nodes-det_hydro_power-generator-math-var-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-math-var" title="Permalink"></a></h3><h4 id="nodes-det_hydro_power-generator-math-var-stand"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-math-var-stand">Standard variables</a><a id="nodes-det_hydro_power-generator-math-var-stand-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-math-var-stand" title="Permalink"></a></h4><p>The <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> utilizes the standard variables from the <a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/library/public/nodes/#EnergyModelsBase.NetworkNode">NetworkNode</a>, as described on the page <em><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var">Optimization variables</a></em>.</p><ul><li><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var-opex"><span>$\texttt{opex\_var}$</span></a></li><li><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var-opex"><span>$\texttt{opex\_fixed}$</span></a></li><li><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var-cap"><span>$\texttt{cap\_use}$</span></a></li><li><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var-cap"><span>$\texttt{cap\_inst}$</span></a></li><li><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var-flow"><span>$\texttt{flow\_in}$</span></a></li><li><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/manual/optimization-variables/#man-opt_var-flow"><span>$\texttt{flow\_out}$</span></a></li></ul><h4 id="nodes-det_hydro_power-generator-math-add"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-math-add">Additional variables</a><a id="nodes-det_hydro_power-generator-math-add-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-math-add" title="Permalink"></a></h4><p>In addition to the standard variables, the variables presented below are defined for <a href="../../../library/internals/types-EMRP/#EnergyModelsRenewableProducers.HydroUnit"><code>HydroUnit</code></a>. These variabels are hence created for <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> nodes.</p><ul><li><p><span>$\texttt{discharge\_segments}[n, t, q]$</span>: One discharge variable is defined for each segment <code>q</code> of the PQ-curve defined by the field <code>pq_curve</code> of node <span>$n$</span> in operational period <span>$t$</span> with unit volume per time unit.<br/>If <a href="../../../library/public/#EnergyModelsRenewableProducers.PqPoints"><code>PqPoints</code></a> are provided, the number of discharge segments will be <span>$Q$</span>, where <span>$Q+1$</span> is the length of the vectors in the fields of <a href="../../../library/public/#EnergyModelsRenewableProducers.PqPoints"><code>PqPoints</code></a>. There is only one discharge segment if an energy equivalent is used. The variables <span>$\texttt{discharge\_segments}$</span> define the utilisation of each discharge segment and sum up to the total discharge.</p><div class="admonition is-warning"><header class="admonition-header">discharge_segments</header><div class="admonition-body"><p>Sequential allocation is not enforced by binary variables, but allocation will occure sequentially if the problem if set up correctly. Penalties for spilling water, a non-concave PQ-curve or an otherwise non-convex problem are examples thay may result in a non-sequential allocation.</p></div></div></li></ul><p>The following variables are created if required by the <em><a href="../description/#nodes-det_hydro_power-phil-con">additional constraints</a></em>:</p><ul><li><span>$\texttt{gen\_penalty\_up}[n, t, p]$</span>: Variable for penalizing violation of the maximum constraint of the resource <code>p</code> in direction <em>up</em> in <code>HydroGenerator</code> node <span>$n$</span> in operational period <span>$t$</span> with unit volume per time unit.<br/><em>Up</em> implies in this case that the electricity generation is larger than planned.</li><li><span>$\texttt{gen\_penalty\_down}[n, t, p]$</span>: Variable for penalizing violation of the maximum constraint of the resource <code>p</code> in direction <em>down</em> in <code>HydroGenerator</code> node <span>$n$</span> in operational period <span>$t$</span> with unit volume per time unit.<br/><em>Down</em> implies in this case that the electricity generation is smaller than planned.</li></ul><h3 id="nodes-det_hydro_power-generator-math-con"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-math-con">Constraints</a><a id="nodes-det_hydro_power-generator-math-con-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-math-con" title="Permalink"></a></h3><p>In the following sections the vector of <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> nodes are omitted from the descriptions. Instead, it is implicitly assumed that the constraints are valid <span>$\forall n ∈ N$</span> for all <a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> types if not stated differently. In addition, all constraints are valid <span>$\forall t \in T$</span> (that is in all operational periods) or <span>$\forall t_{inv} \in T^{Inv}$</span> (that is in all strategic periods).</p><h4 id="nodes-det_hydro_power-generator-math-con-stand"><a class="docs-heading-anchor" href="#nodes-det_hydro_power-generator-math-con-stand">Standard constraints</a><a id="nodes-det_hydro_power-generator-math-con-stand-1"></a><a class="docs-heading-anchor-permalink" href="#nodes-det_hydro_power-generator-math-con-stand" title="Permalink"></a></h4><p><a href="../../../library/public/#EnergyModelsRenewableProducers.HydroGenerator"><code>HydroGenerator</code></a> nodes utilize in general the standard constraints described in <em><a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/nodes/networknode/#nodes-network_node-math-con">Constraint functions for <code>NetworkNode</code></a></em>. The majority of these constraints are hence ommitted in the following description.</p><p>The function <code>constraints_capacity</code> rquires a new method to account for the included <a href="../description/#nodes-det_hydro_power-phil-pq">PQ-curve</a>:</p><p class="math-container">\[\begin{aligned}
    \texttt{cap\_use}&amp;[n, t] \leq \texttt{cap\_inst}[n, t] \times P_{norm}^{max}\\
\end{aligned}\]</p><p>Where <code>capacity(n, t)</code> is the installed capacity of node <code>n</code> in operational period <code>t</code> and <span>$P_{norm}^{max}$</span> is the maximum normalized power capacity identified through the function <a href="../../../library/internals/methods-fields/#EnergyModelsRenewableProducers.max_normalized_power"><code>max_normalized_power</code></a>. If the capacity refers to power, the <code>PqPoints</code> <code>power_levels</code> ranges between 0 and 1 and <span>$P_{norm}^{max}$</span> will also be 1. If the capacity refers to flow, the <code>discharge_levels</code> ranges between 0 and 1, while <code>power_levels</code> may take other values and <span>$P_{norm}^{max}$</span> represents the last element of the <code>power_levels</code> vector.</p><p>The function <code>constraints_opex_var</code> requires a new method as we have to include the penalty variables for violating the constraints if required:</p><p class="math-container">\[\begin{aligned}
  \texttt{opex\_var}&amp;[n, t_{inv}] = \\
    \sum_{t \in t_{inv}}  \Big( &amp;opex\_var(n, t) \times \texttt{cap\_use}[n, t] + \\&amp;
    \sum_{p \in P^{res}} \Big( penalty(c_{up}, t) \times \texttt{gen\_penalty\_up}[n, t, p] + \\&amp;
    penalty(c_{down}, t) \times \texttt{gen\_penalty\_down}[n, t, p] \Big) \Big) \times scale\_op\_sp(t_{inv}, t)
\end{aligned}\]</p><p>where <span>$penalty()$</span> returns the penalty value for violation in the upward and downward direction of constraints with penalty variables, denoted by <span>$c_{up}$</span> and  <span>$c_{up}$</span> respectively. The set <span>$P^{res}$</span> contains the water and power resources of node <code>n</code>.</p><div class="admonition is-success"><header class="admonition-header">The function `scale_op_sp`</header><div class="admonition-body"><p>The function <a href="https://energymodelsx.github.io/EnergyModelsBase.jl/stable/library/public/functions/#EnergyModelsBase.scale_op_sp"><span>$scale\_op\_sp(t_{inv}, t)$</span></a> calculates the scaling factor between operational and strategic periods. It also takes into account potential operational scenarios and their probability as well as representative periods.</p></div></div><p>Furthermore, we provide new methods for the flow constraints for <code>HydroGenerator</code> nodes:</p><ul><li><p><code>constraints_flow_in</code>:<br/>It is assumed that the amount of water is constant for <code>HydroGenerator</code> nodes, and the flow of water into the node therefore equals the flow out:</p><p class="math-container">\[\texttt{flow\_in}[n, t, water\_resource(n)] = \texttt{flow\_out}[n, t, water\_resource(n)]\]</p></li><li><p><code>constraints_flow_out</code>:<br/>The flow out of water is constrained to total discharge given by the sum of the <span>$\texttt{discharge\_segments[n,t,q]}$</span> variables, where Q is the number of segments in the PQ-curve (<em>i.e.</em>, Q+1 PQ-points):</p><p class="math-container">\[\texttt{flow\_out}[n, t, water\_resource(n)] = \sum_{q=1}^{Q}\texttt{discharge\_segments[n,t,q]}\]</p><p>The flow of electricity out of the node is given by the <span>$\texttt{cap\_use}[n, t]$</span> variables:</p><p class="math-container">\[\texttt{flow\_out}[n, t, electricity\_resource(n)] = \texttt{cap\_use}[n, t]\]</p><p>In addition to being constrained by the installed capacity, the variables <span>$\texttt{cap\_use}$</span>  are constrained by the discharge of water multiplied with the conversion rate given by <span>$\texttt{E[q]}$</span> which is the slope of each segment in the PQ-curve:</p><p class="math-container">\[\texttt{cap\_use}[n, t] = \sum_{q=1}^{Q}(\texttt{discharge\_segments}[n,t,q] \times \texttt{E[q]})\]</p><p>The discharge segments are constrained by the <code>discharge_levels</code> of the <a href="../../../library/public/#EnergyModelsRenewableProducers.PqPoints"><code>PqPoints</code></a>:</p><p class="math-container">\[\begin{aligned}
    \texttt{discharge\_segment}[n, t, q] \leq &amp; capacity(n, t) \times (discharge\_levels[q+1] \\ &amp;
    - discharge\_levels[q]) \qquad \forall q \in [1,Q] \\
\end{aligned}\]</p><p>The <code>capacity(n, t)</code> returns the installed capacity and is used to scale the relative values of the  <a href="../../../library/public/#EnergyModelsRenewableProducers.PqPoints"><code>PqPoints</code></a> to absolute values.</p></li></ul><div class="admonition is-info"><header class="admonition-header">Energy equivalent</header><div class="admonition-body"><p>If a single energy equivalent is used, two points (zero and max) are created to describe a single discharge segment with the slope of the energy equivalent and the capacity of node <code>n</code>. In this case, the installed capacity of the node, provided in the <code>pq_curve::AbstractPqCurve</code> field, has to refer to the power capacity.</p></div></div><p>Furthermore, the method for <code>constraints_flow_out</code> adds <em><a href="../description/#nodes-det_hydro_power-phil-con">discharge and power capacity constraints</a></em> if additional constraints are provided in the <code>Data</code> field. Soft constraints, <em>i.e.</em>, constraints with a penalty, are used if the constraints have non-infinite penalty values. For <code>HydroGenerator</code> nodes, the constraints can be defined for both the <code>electricity_resource</code> and <code>water_resource</code>. The mathematical formualtion of the constraints are:</p><ol><li><p>Minimum constraints for discharge or power generation:</p><p class="math-container">\[\begin{aligned}
  \texttt{flow\_out}[n, t, p] \geq &amp; capacity(n, t, p) \times value(c, t) \qquad &amp; \forall c \in C^{min}\\
  \texttt{flow\_out}[n, t, p] + \&amp; \texttt{gen\_penalty\_up}[n, t, p] \geq \\ &amp;
     capacity(n, t, p) \times value(c, t) \qquad &amp; \forall c \in C^{min} \\
\end{aligned}\]</p></li><li><p>Maximum constraints for discharge or power generation:</p><p class="math-container">\[\begin{aligned}

  \texttt{flow\_out}[n, t, p] \leq &amp; capacity(n, t, p) \times value(c, t) \qquad &amp; \forall c \in C^{max}\\
  \texttt{flow\_out}[n, t, p] - &amp; \texttt{gen\_penalty\_down}[n, t, p] \leq \\ &amp;
     capacity(n, t, p) \times value(c, t) \qquad &amp; \forall c \in C^{max} \\

\end{aligned}\]</p></li><li><p>Scheduling constraints for discharge or power generation:</p><p class="math-container">\[\begin{aligned}
  \texttt{flow\_out}[n, t, p] = &amp; capacity(n, t, p) \times value(c, t) \qquad &amp; \forall c \in C^{sch}\\
  \texttt{flow\_out}[n, t, p] + &amp; \texttt{gen\_penalty\_up}[n, t, p] - \texttt{gen\_penalty\_down}[n, t] = \\ &amp;
  capacity(n, t, p) \times value(c, t) \qquad &amp; \forall c \in C^{sch} \\
\end{aligned}\]</p></li></ol><p>where <span>$value(c,t)$</span> returns the relative limit of constraint <code>c</code> and  <span>$capacity(n,t, p)$</span> returns the installed capacity of node <code>n</code> for resource <code>p</code>. The sets <span>$C^{min}$</span>,<span>$C^{max}$</span>, and <span>$C^{sch}$</span> contain additional minimum, maximum and scheduling constraints, repectively.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reservoir/">« Hydro reservoir node</a><a class="docs-footer-nextpage" href="../pump/">Hydro pump node »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 27 November 2024 14:16">Wednesday 27 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
